# CRISPR-AIdit

## System Requirements 

The code were tested on Windows, Linux and Mac OS systems.

#### Install a python 3.6 software or create a python 3.6 virtual environment and activate it

```
# Installation guide

wget https://www.python.org/ftp/python/3.6.9/Python-3.6.9.tgz  
tar -zxvf Python-3.6.9.tgz  
cd python-3.6.9  
./configure --prefix=/usr/local/python3.6 --enable-optimizations
make && make install

# Install Python dependencies

pip install -r requirements.txt
```

## CRISPR-AIdit Web Server

To predict and download profiles for individual gRNAs,  the graphical user 846
interface (GUI) is available at:

https://crispr-aidit.com

## CRISPR-AIdit Command Line Tool

Follow the installation instructions [here](##System%20Requirements).

***
### For on-target prediction, from a command line:
```
cd predictors/on-target
```

##### Single gRNA prediction

e.g.

```
python on_target_predict.py K562 ATTCACGAAGGGCTGCAGGAAGCGTACCCCCAGGTCTTGCAGGTCCTCGGGAGGCTTCACCTC
```

Parameter 1: a cell line type chosen from [K562, Jurkat], e.g. K562  
Parameter 2: a 63bp target sequence (20bp upstream + 20bp target + 3bp PAM + 20bp downstream)  
Output will be:  
An indel efficiency value generated by the corresponding model e.g. AIdit_K562_ON


#### Batch gRNA prediction

e.g.

```
python predict.py K562 demo_dataset.txt ./result
```

Parameter 1: a cell line type chosen selected from [K562, Jurkat], e.g. cell=K562  
Parameter 2: an input file path with a named 'target sequence' column, which contains the 63bp sequences (i.e. 20bp upstream + 20bp target + 3bp PAM + 20bp downstream)  
Parameter 3: an output directory to save your result file.   
e.g. 

Output will be in:  

./result/predicted_result_Aidit_ON_K562.txt  

The output file is a tab-delimited file with columns: target sequence, efficiency. e.g.  

```
'target sequence' efficiency
ATTCACGAAGGGCTGCAGGAAGCGTACCCCCAGGTCTTGCAGGTCCTCGGGAGGCTTCACCTC 0.07399143
```

***

### For off-target prediction, from a command line:

```
cd predictors/off-target
```

#### Off-target prediction

e.g.

```
python off_target_predict.py demo_dataset.txt ./result
```

Parameter 1: an input file in which there are two columns *target sequence* and *off-target sequence*   

*target sequence*: 63bp wild-type sequence (20bp upstream + 20bp target + 3bp PAM + 20bp downstream)  
*off-target sequence*: 63bp off-target sequence (20bp upstream + 20bp off-target + 3bp PAM + 20bp downstream)  

Parameter 2: an output directory to save your result file.
e.g.

Output will be in:

./result/predicted_result_Aidit_OFF.txt

The output file is a tab-delimited file with columns: target sequence, off-target sequence,	off-target_score. e.g.  

```
'target sequence' 'off-target sequence' off-target_score  
GTACCTCAGCCAGCATGGCAGCCTCTTTCCCACCCACCTTGGGACTCAGTTCTGCCCCAGATG	GCTCATGCTTGTCTCTCTCTTCCTCCTCGCCACCCACCTTCTGCCAGCTAGGGCGGCACTGTC	0.0077138780512889474
```

***

### For DSB-induced repair outcome prediction, from a command line:  

```
cd predictors/DSB_repair
```

#### DSB-induced repair outcome prediction

e.g. 

```
python DSB_repair_predict.py K562 demo_dataset.txt ./result
```

Parameter 1: a cell line type chosen from [K562, Jurkat].   
Parameter 2: an input file with one column *target sequence*   

*target sequence*: 63bp wild-type sequence (20bp upstream + 20bp target + 3bp PAM + 20bp downstream)  

Parameter 3: an output directory to save your result file.
e.g.

Output will be in: 

./result/predicted_result_Aidit_DSB_{cell}.txt  

The output file is a tab-delimited file with columns: target sequence, repair categories. e.g.  

```
'target sequence' I-1_T I-1_A /.../ 34:34D-1 /...
CAGATTAGTCGATGCAAATGTTAAAAACGTGTTGGCAAGCTGGATGAGCAGGTTTGTATTTTAGTTTGTATTACCGCCATGCATT 0.0051173484 0.46273008 /.../ 0.0006484685 /...  
```

> #### Note:  
> Each column for repair categories represents one of the DSB-induced repair outcomes, as specified by an identifier string.  
> 
> e.g.   
> 
>  And the identifier ‘I-1_C’ represents insertion of a single cytosine at the cut site between position 37th and 38th, counting 1 from the sequence leftmost.  
> ‘34:35D-1’ describes a size 2bp deletion from position 34th to 35th of the wild-type sequence, counting 1 from leftmost.   

***

## Folders Description

***

* The folder [analysis-notebook](analysis-notebook) contains ipynb files and some datasets for analysis, comparison, evaluation and visualization for data and models of On-target, Off-Target and DSB-induced repair, respectively. [See details at analysis-notebook/README.md](analysis-notebook/README.md) 
* The folder [predictors](predictors) contains the prediction codes, the final model files and some demo datasets for On-target, Off-Target and DSB repair, respectively. [See details at predictors/README.md](predictors/README.md)  
* The folder [training-evaluation](training-evaluation) contains the codes, scripts and some demo datasets for feature engineering, model training and evaluation of On-target, off-target and DSB repair, respectively. [See details at: training & evaluation/README.md](training-evaluation/README.md)
